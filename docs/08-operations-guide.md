# 運用ガイド

## 1. 日常運用

### 1.1 通常の実行フロー

1. 初回面談の書き起こしを取得する（音声→文字起こしツール等）
2. 書き起こしを `data/transcripts/` に保存する
3. 以下のコマンドで実行する:
   ```bash
   python src/main.py --input data/transcripts/YYYYMMDD_顧客名.txt
   ```
4. Slack でFBを確認する

### 1.2 複数件の処理

```bash
python src/main.py --input-dir data/transcripts/
```

---

## 2. 参照ドキュメントの更新

### 2.1 PSSマニュアルの更新

1. `reference/pss/` 内のファイルを編集する
2. 変更を保存する
3. 次回のFB生成から自動的に反映される
4. （推奨）変更履歴を Git で管理する

### 2.2 オペレーションマニュアルの更新

1. `reference/operations/` 内のファイルを編集する
2. 同様に次回から反映される

---

## 3. トラブルシューティング

### 3.1 FBが生成されない

| 原因 | 対処 |
|------|------|
| APIキー未設定・不正 | .env の OPENAI_API_KEY / ANTHROPIC_API_KEY を確認 |
| トークン超過 | 書き起こしが長すぎる場合は分割を検討 |
| 参照ドキュメントが見つからない | reference/pss/, reference/operations/ のパスを確認 |

### 3.2 Slackに送信されない

| 原因 | 対処 |
|------|------|
| トークン未設定・不正 | SLACK_BOT_TOKEN を確認 |
| チャンネルにBotが参加していない | SlackでBotをチャンネルに追加（/invite @Bot名） |
| 権限不足 | Bot に chat:write スコープがあるか確認 |

### 3.3 FBの品質が期待と異なる

| 対処 | 内容 |
|------|------|
| プロンプト調整 | config/prompts/ のテンプレートを修正 |
| 参照ドキュメントの明確化 | PSS・オペレーションマニュアルをより具体的に |
| サンプルFBの追加 | プロンプトに良いFB例を few-shot で追加 |

---

## 4. ログ・監視

### 4.1 ログ出力

- 標準出力: 実行結果・エラーメッセージ
- ファイル: `logs/` に日付ごとのログを出力（任意実装）

### 4.2 監視ポイント

- 実行成功率
- API 呼び出し失敗（レート制限・タイムアウト）
- Slack 送信失敗

---

## 5. バックアップ・復旧

- `reference/` のドキュメントは Git で版管理を推奨
- `.env` はバックアップしない（機密情報のため）
- 書き起こし・FB履歴は必要に応じて別途バックアップ

---

## 6. 問い合わせ・エスカレーション

- 技術的な問題: 開発担当
- PSS・オペレーション内容の変更: 営業管理・マネージャー
- Slack 設定: Slack 管理者
