# ユースケース

## 1. ユースケース一覧

| UC-ID | ユースケース名 | アクター | 概要 |
|-------|----------------|----------|------|
| UC-01 | 書き起こしからFBを生成しSlackへ送信 | 営業担当 | メインシナリオ |
| UC-02 | 複数件の書き起こしを一括処理 | 営業担当/管理者 | バッチ処理 |
| UC-03 | FBの送信先を変更 | 管理者 | 設定変更 |
| UC-04 | PSS/オペレーションマニュアルを更新 | 管理者 | 参照ドキュメント更新 |

---

## 2. UC-01: 書き起こしからFBを生成しSlackへ送信

### 概要

営業担当が初回面談の書き起こしを投入し、エージェントがPSS・オペレーションマニュアルに基づいてFBを生成し、Slackに送信する。

### アクター

- **営業担当**: 書き起こしを準備し、システムを実行する

### 前提条件

- PSSマニュアルが `reference/pss/` に格納されている
- オペレーションマニュアルが `reference/operations/` に格納されている
- Slack Bot Token が設定されている
- 送信先チャンネル/ユーザーが設定されている

### 基本フロー

1. 営業担当が面談の書き起こしを取得する（音声→文字起こしなど）
2. 営業担当が書き起こしファイルを指定してエージェントを実行する
3. システムが書き起こしを読み込む
4. システムが PSS・オペレーションマニュアルを参照する
5. システムがLLMを用いてFBを生成する
6. システムがFBをSlackに送信する
7. 営業担当がSlackでFBを確認する

### 代替フロー

**5a. FB生成失敗**

- エラーメッセージを表示し、ログに記録する
- リトライオプションを提供する

**6a. Slack送信失敗**

- リトライする（最大3回）
- 失敗時はローカルにFBを保存し、エラー通知を出す

### 事後条件

- SlackにFBが投稿される
- 実行ログが記録される（任意）

### 画面/操作イメージ

```
[入力] 書き起こしファイル（.txt / .md）
       ↓
[実行] CLI: python run_fb.py --input transcript.txt
       または Cursor エージェントに投げる
       ↓
[出力] Slack チャンネルにFBが投稿される
```

---

## 3. UC-02: 複数件の書き起こしを一括処理

### 概要

複数の書き起こしをまとめて処理し、それぞれのFBをSlackに送信する。

### アクター

- 営業担当 / 管理者

### 基本フロー

1. 営業担当が複数ファイルが入ったディレクトリを指定する
2. システムが各ファイルを順次処理する
3. 各件ごとにFBを生成しSlackに送信する
4. 処理結果のサマリを表示する

### 事後条件

- 全件分のFBがSlackに送信される
- 失敗した件はログに記録される

---

## 4. UC-03: FBの送信先を変更

### 概要

Slackの送信先チャンネルまたはユーザーを変更する。

### アクター

- 管理者

### 基本フロー

1. 管理者が設定ファイルまたは環境変数を編集する
2. `SLACK_CHANNEL` または `SLACK_USER_ID` を変更する
3. 次回実行から新しい送信先に送信される

---

## 5. UC-04: PSS/オペレーションマニュアルを更新

### 概要

参照ドキュメントを更新し、次回以降のFB生成に反映する。

### アクター

- 管理者

### 基本フロー

1. 管理者が `reference/pss/` または `reference/operations/` のファイルを編集する
2. 変更を保存する
3. 次回のFB生成から新しい内容が参照される
4. （任意）バージョン管理で差分を確認する

### 格納場所の再確認

| ドキュメント | 格納パス |
|--------------|----------|
| PSSマニュアル | `reference/pss/` |
| オペレーションマニュアル | `reference/operations/` |
